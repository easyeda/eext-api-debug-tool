<!doctype html>
<html lang="zh-CN">
	<head>
		<meta charset="UTF-8" />
		<title>Ace Editor - EDA</title>
		<link id="theme-light" rel="stylesheet" href="/iframe/style/body-light.css" disabled />
		<link id="theme-dark" rel="stylesheet" href="/iframe/style/body-dark.css" />
		<!-- 风格文件 -->
		<link rel="stylesheet" href="/iframe/script/SweetAlert2/sweetalert2.min.css" />
	</head>
	<body>
		<div id="app">
			<div id="sidebar">
				<ul>
					<li><button id="run-btn">运行</button></li>
					<li><button id="import-btn">导入</button></li>
					<li><button id="load-btn">加载</button></li>
					<li><button id="save-btn">保存</button></li>
					<li><button id="delete-btn">删除</button></li>
					<li><button id="setting-btn">切换主题</button></li>
					<li><button id="SaveinLeft-btn">保存到列表</button></li>
					<li><button id="Ext-btn">插件管理</button></li>
					<li><button id="ai-btn">AI辅助</button></li>
					<!-- <li><button id="example-btn" style="display: none;">案例</button></li>
					<li><button id="about-btn" style="display: none;">关于</button></li> -->
				</ul>
			</div>
			<div id="editor-container">
				<div id="editor"></div>
			</div>
		</div>

		<!-- Ace 插件资源等 -->
		<script src="/iframe/script/Ace_Editor/ace.js"></script>
		<script src="/iframe/script/Ace_Editor/ext-language_tools.js"></script>
		<script src="/iframe/script/Ace_Editor/mode-javascript.js"></script>
		<script src="/iframe/script/Ace_Editor/ext-searchbox.js"></script>
		<script src="/iframe/script/Ace_Editor/ext-options.js"></script>
		<script src="/iframe/script/Ace_Editor/ext-modelist.js"></script>
		<script src="/iframe/script/Ace_Editor/ext-themelist.js"></script>
		<script src="/iframe/script/Ace_Editor/ext-settings_menu.js"></script>
		<script src="/iframe/script/Ace_Editor/ext-prompt.js"></script>
		<script src="/iframe/script/Js_beautify/beautify-css.min.js"></script>
		<script src="/iframe/script/Js_beautify/beautify.min.js"></script>
		<script src="/iframe/script/Js_beautify/beautify-html.min.js"></script>
		<script src="/iframe"></script>
		<!-- 以下全都是ACE的风格文件，如果有需要可以自己添加 东西都在Ace_Editor文件夹里-->
		<script src="/iframe/script/Ace_Editor/theme-monokai.js"></script>
		<script src="/iframe/script/Ace_Editor/theme-github.js"></script>
		<!-- 一些编辑器支持 不想每个都写注释了 自己跳进去看吧 -->
		<script src="/iframe/script/User_config/message.js"></script>
		<script src="/iframe/script/eda_coder/EDA_Codes.js"></script>
		<script src="/iframe/script/User_config/ACE_Config.js"></script>
		<script src="/iframe/script/User_config/Code_Config.js"></script>
		<!-- SweetAlert JS模态框资源 -->
		<script src="/iframe/script/SweetAlert2/sweetalert2@11.js"></script>

		<script>
			//初始化Ace 编辑器
			const settingsMenu = ace.require('ace/ext/settings_menu');
			const editor = ace.edit('editor');
			ACE_Init(editor);

			// 注册放大缩小代码支持
			let currentFontSize = 14;
			ACE_ChangeCodeSize(editor, currentFontSize, showToast);

			//注册EDA智能补全
			ACE_CodingForEDA(editor, edcode);

			//获取当前编辑器主题
			const light_theme = document.getElementById('theme-light');
			const dark_theme = document.getElementById('theme-dark');
			GetTheme(editor, light_theme, dark_theme);

			//扫描插件并执行
			ExtStore_LoadAndRunAllPlugins();
			//加载按钮到左侧
			Code_LoadBtnListFromDB(editor);

			//保存代码到左侧列表
			document.getElementById('SaveinLeft-btn').addEventListener('click', () => {
				Code_SaveToBtnList(editor);
			});
			// 运行代码
			document.getElementById('run-btn').addEventListener('click', () => {
				ACE_RunCode(editor);
			});
			// 开启AI辅助支持
			document.getElementById('ai-btn').addEventListener('click', () => {
				activateECTAI(editor);
			});
			// 保存代码
			document.getElementById('save-btn').addEventListener('click', async () => {
				// await eda.sys_Message.showToastMessage('这个还没写', 'info', 1);
				Code_SaveCode(editor);
			});
			//加载代码
			document.getElementById('load-btn').addEventListener('click', async () => {
				// await eda.sys_Message.showToastMessage('这个还没写', 'info', 1);
				Code_OpenLoadWindow(editor);
			});
			//编辑器设置
			document.getElementById('setting-btn').addEventListener('click', async () => {
				// await eda.sys_Message.showToastMessage('这个还没写');
				SetTheme(editor, light_theme, dark_theme);
			});
			//删除代码
			document.getElementById('delete-btn').addEventListener('click', async () => {
				// await eda.sys_Message.showToastMessage('这个还没写', 'info', 1);
				eda.sys_Message.showToastMessage('注意，这玩意不会问你是否删除，点一下立马删，三思而后行', 'warn', 3);
				Code_OpenDeleteWindow(editor);
			});
			//导入JS文件
			document.getElementById('import-btn').addEventListener('click', async () => {
				ImportFile(editor);
			});
			//保存到插件
			document.getElementById('Ext-btn').addEventListener('click', async () => {
				showPluginManagerModal(editor);
			});
			//注册文件跳转支持
			const methodList = edcode.map((item) => item.methodPath); // 保留 'eda.XXX'
			injectContextMenuJumpToDocs(editor, methodList);
			//绑定运行快捷键
			document.addEventListener('keydown', function (event) {
				if ((event.ctrlKey || event.metaKey) && event.key === 'Enter') {
					ACE_RunCode(editor);
				}
			});
		</script>
		<!-- 一些资源文件 这些都不是必要的 删除也没什么影响 只不过用户也许会换主题所以放进来-->
		<script src="/iframe/script/Ace_Editor/theme-ambiance.js"></script>
		<script src="/iframe/script/Ace_Editor/theme-chaos.js"></script>
		<script src="/iframe/script/Ace_Editor/theme-chrome.js"></script>
		<script src="/iframe/script/Ace_Editor/theme-clouds.js"></script>
		<script src="/iframe/script/Ace_Editor/theme-clouds_midnight.js"></script>
		<script src="/iframe/script/Ace_Editor/theme-cobalt.js"></script>
		<script src="/iframe/script/Ace_Editor/theme-crimson_editor.js"></script>
		<script src="/iframe/script/Ace_Editor/theme-dreamweaver.js"></script>
	</body>
</html>
